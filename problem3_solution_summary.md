"""
问题三：完整解决方案总结
========================

目标：
1. 尽量多地采购A类原材料，尽量少地采购C类原材料
2. 减少转运及仓储成本
3. 降低转运损耗率
4. 满足每周28200立方米的生产需求

解决方案概述：
我实现了两种优化策略，经过对比分析，推荐策略2（优先级驱动策略）。

策略2优化结果：
===============

供应商组合构成：
- 总供应商数量：40家（比问题二的最少供应商数量多了适当数量以提高稳定性）
- A类供应商：14家，承担33.0%的供货量
- B类供应商：16家，承担34.3%的供货量  
- C类供应商：10家，承担32.7%的供货量

关键改进指标：
- A类材料比例：从29.8%提升到33.0%（+3.1%）
- C类材料比例：从40.3%降低到32.7%（-7.6%）
- 转运损耗率：1.57%（较低水平）
- 单位成本：0.5588（相比策略1降低了1.3%）

主要供应商配置：
================

A类原材料主要供应商（按供货量排序）：
1. S229：40,871立方米（36.1%）- 最大A类供应商
2. S275：14,455立方米（12.8%）
3. S329：13,443立方米（11.9%）
4. S282：13,365立方米（11.8%）
5. S352：10,379立方米（9.2%）

B类原材料主要供应商：
1. S140：19,624立方米（16.6%）
2. S139：18,034立方米（15.3%）
3. S108：16,901立方米（14.3%）
4. S340：16,219立方米（13.7%）
5. S131：11,934立方米（10.1%）

C类原材料主要供应商（优化减少）：
1. S374：26,182立方米（23.3%）
2. S361：21,538立方米（19.2%）
3. S356：17,471立方米（15.5%）
4. S151：12,872立方米（11.5%）
5. S306：9,455立方米（8.4%）

优化算法特点：
==============

1. 优先级驱动策略：
   - 第一阶段：A类优先，目标覆盖50%产能需求
   - 第二阶段：B类EOQ模型优化，平衡成本与需求
   - 第三阶段：C类最少化，仅填补缺口

2. 转运方案优化：
   - A类材料：优先分配给综合评分最高的转运商（T1、T2、T3）
   - B类材料：使用中等评分转运商
   - C类材料：使用剩余运力，确保低成本运输

3. 供应商选择策略：
   - 基于问题一的Top50排名，优先选择高可靠性供应商
   - 扩展到Top50以外的供应商，确保A类材料充足供应
   - 使用机器学习预测模型预测供应商供货能力

技术实现亮点：
==============

1. 机器学习预测：
   - 使用ARIMA、Holt-Winters等时间序列模型
   - 预测每个供应商24周的供货能力
   - 提高订购计划的准确性

2. EOQ模型应用：
   - 对B类材料应用经济订货量模型
   - 平衡订货成本和仓储成本
   - 优化批量采购策略

3. 多目标优化：
   - 成本最小化（权重40%）
   - 损耗最小化（权重30%）
   - A类最大化（权重20%）
   - C类最小化（权重10%）

实施效果分析：
==============

成本效益：
- 通过增加A类（高价值）材料比例，虽然单价较高，但转换效率更高
- 减少C类材料使用，降低了总体仓储需求
- 优化转运商配置，将高价值材料分配给低损耗率转运商

供应链稳定性：
- 选择40家供应商，比最少数量适当增加，提高供应安全性
- 分散采购风险，避免过度依赖少数供应商
- 每种材料都有多个备选供应商

周度供应模式：
- A类材料供应稳定（变异系数0.02）
- B类材料适度波动（变异系数0.05）
- C类材料允许较大波动（变异系数0.11），但总量控制在最低水平

文件说明：
==========

生成的主要文件：
1. problem3_strategy2_orders.xlsx - 推荐的24周订购方案
2. problem3_strategy2_transport.xlsx - 对应的转运方案
3. problem3_strategy2_evaluation.txt - 详细评估结果
4. problem3_supplier_selection_report.txt - 供应商选择报告
5. problem3_strategy_comparison.png - 策略对比可视化图表

使用说明：
==========

1. 订购方案数据格式：
   - week: 周数（1-24）
   - supplier_id: 供应商编号
   - order_amount: 订购量（立方米）

2. 转运方案数据格式：
   - week: 周数（1-24）
   - supplier_id: 供应商编号
   - transporter_name: 转运商名称
   - transport_amount: 转运量（立方米）

3. 可直接用于填写附件A（订购方案）和附件B（转运方案）

总结：
======

问题三的解决方案成功实现了：
✓ A类材料比例提升至33.0%
✓ C类材料比例降低至32.7%
✓ 转运损耗率控制在1.57%
✓ 单位成本降低1.3%
✓ 供应链稳定性提升

该方案在满足生产需求的前提下，有效压缩了生产成本，优化了原材料结构，
降低了转运损耗，为企业带来显著的经济效益。
"""
